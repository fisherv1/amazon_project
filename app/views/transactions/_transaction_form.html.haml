- form_for transaction, :html => {:class => "ajax_form", :id => transaction.new_record? ? "new_transaction_header_form" : "edit_transaction_header_form", :submit_button_id => transaction.new_record? ? "new_submit_button" : "edit_submit_button"} do |f|
  .form_line
    .field_15
      = f.label :todays_date, "System Date"
      %input{:style => "display:none;", :value => "#{@system_date}", :name => "transaction_header[todays_date]"}
      .display_field_bg
        #{@system_date.to_s}      

    .field_15
      = f.label :transaction_date, "<span class='asterisk'>*</span>Transaction Date"
      = f.text_field :transaction_date, :value => transaction.transaction_date.to_s, :class => "compulsory_field datepick"

    .field_20
      = f.label :bank_account_id, "<span class='asterisk'>*</span>Bank Account"
      = f.collection_select :bank_account_id, ClientBankAccount.active_client_bank_account, :id, :account_number

    .field_10
      = f.label :banked, "Already Banked"
      = f.check_box :banked

    .field_15
      = f.label :letter_id, "<span class='asterisk'>*</span>Single Letter ID"
      %select

  .form_line
    .field_15
      = f.label :receipt_meta_type_id, "<span class='asterisk'>*</span>Receipt Meta Type"
      = f.collection_select :receipt_meta_type_id, ReceiptMetaMetaType.active_receipt_meta_meta_type, :id, :name, {}, {:class => "select_ajax_call", :method => "GET", :url => "/tag_types/show_receipt_type", :type_class => "new"}

    .field_15
      = f.label :receipt_type_id, "<span class='asterisk'>*</span>Receipt Type"
      - if ReceiptMetaMetaType.first.nil?
        %select{:disabled => true}
      - else
        = f.collection_select :receipt_type_id, ReceiptMetaType.find(:all, :conditions => ["tag_meta_type_id = ? AND status = true and to_be_removed = false", ReceiptMetaMetaType.first.id], :order => "name"), :id, :name, {}, {:id => "receipt_type"}

    .field_15
      = f.label :received_via_id, "<span class='asterisk'>*</span>Receipt Via"
      = f.collection_select :received_via_id, ReceivedVia.active_received_via, :id, :name

  #cash_detail_form
    
  #cheque_detail_form
    -#= render :partial => "transaction_type_details/cheque_detail_form"

  #credit_card_detail_form
    -#= render :partial => "transaction_type_details/credit_card_detail_form"
    

  .form_line{:style => "height:auto;"}
    .field_100{:style => "height:auto;"}
      = f.label :notes, "Notes"
      = f.text_area :notes, :rows => 3, :cols => 45, :class => "mceNoEditor"


%input.hidden{:id => "transaction_allocation_mode", :mode => "show"}
#add_new_transaction_allocation
  = render :partial => "/transaction_allocations/new_transaction_allocation"

#existing_transaction_allocations
  = render :partial => "transaction_allocations/existing_temp_transaction_allocations"

#edit_transaction_allocation{:style => "display:none;margin-top:10px;float:left;width:100%;"}
  .tab_looking_left
  .tab_looking_icon
    = image_tag('edit_icon.png')
    Maintenance
  .tab_looking_right

  %div.tab_close
    .tab_looking_left
    .tab_looking_icon
      = link_to_function image_tag('/images/Icons/System/close.png'), :field => "transaction_allocation", :title=>"Close", :class => "close_option", :toggle_id_name => "edit_transaction_allocation", :toggle_id_name1 => "add_new_transaction_allocation"
    .tab_looking_right
      .options

  .full_container
    #edit_transaction_allocation_form


= button_to_function "Submit", :disabled => true, :class => "fake_submit_button", :form_id => "new_transaction_header_form", :id => "new_submit_button", :style => "float:right;margin-top:8px;;margin-left:10px;"

#temp_allocation_total_amount.right{:style => "width:35%;margin-top:10px;"}
  .display_field_bg.right{:style => "width:200px !important;"}
    %div{:id => "temp_allocation_total_amount_value"}
      #{number_to_currency(0)}
  %h2{:class => "float:right;"} Transaction Total:

