%h2 Existing Email Templates

%table#show_message_templates_grid{:class => "selectable_grid"}

%script{:type => "text/javascript", :charset => "utf-8"}
  :plain
    delete_email_from_list = function(){
    var trSelected = $("#show_message_templates_grid tr.trSelected").attr('id');
    var id = "";
    if (trSelected != undefined){
      id = trSelected.substring(3);
      $("#warning_message_text").html("Are you sure you wish to delete this organisation?");
      $("#warning_message").dialog({
        modal:false,
        resizable:false,
        draggable:false,
        height: 'auto',
        width: 'auto',
        buttons:{

        NO: function(){
          $(this).dialog("destroy");

        },

        Yes: function(){
          $.ajax({
                      type: "delete",
                      url: "/communication/destroy_message_template.js",
                      data: "id="+id,
                      dataType: "script"
                  });
                  $(this).dialog('destroy');
                  return true;
              }
              }

          });
        }else{
          $('#warning_message_text').html("Please select the record you want to delete");
          $('#warning_message').dialog({
              modal: true,
              resizable: false,
              draggable: true,
              height: 'auto',
              width: 'auto',
              buttons: {
                  Ok: function(){
                      $(this).dialog('destroy');
                      return false;
                  }
              }

          });
      }
      $('#warning_message_image').css("display","");
      $('#warning_message').dialog('option', 'title', 'Warning');
      $('#warning_message').parent().find("a").css("display","none");
      $("#warning_message").parent().css('background-color','#D1DDE6');
      $("#warning_message").css('background-color','#D1DDE6');
      $('#warning_message').dialog('open');
      return false;
      };


    $("#show_message_templates_grid").flexigrid({
    url: '/grids/show_message_templates_grid',
    dataType: 'json',
    colModel : [
    {
    display: 'ID',
    name : 'id',
    width : 40,
    sortable : true,
    align: 'left'
    },

    {
    display: 'Name',
    name : 'name',
    width : 570,
    sortable : true,
    align: 'left'
    },

    {
    display: 'Created At',
    name : 'created_at',
    width : 270,
    sortable : true,
    align: 'left'
    }

    ],
    buttons : [
            {name: 'Delete', bclass: 'delete', onpress : delete_email_from_list}
        ],
    sortname: "name",
    sortorder: "asc",
    usepager: true,
    title: 'Email Templates',
    useRp: true,
    rp: 20,
    showTableToggleBtn: false,
    width: 'auto',
    height: 'auto'
    });
 